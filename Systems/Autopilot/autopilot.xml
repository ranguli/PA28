<?xml version="1.0"?>
<!-- This autopilot file switches between S-TEC-55X and KAP140 -->
<PropertyList>
	<filter>
		<name>AILERON OUTPUT</name>
		<type>noise-spike</type>
		<enable>
			<condition>
				<or>
					<and>
						<greater-than>
							<property>/it-stec55x/output/roll</property>
							<value>-1</value>
						</greater-than>
						<equals>
							<property>/it-stec55x/internal/servo-roll-power</property>
							<value>1</value>
						</equals>
						<equals>
							<property>/it-stec55x/settings/use-controls-flight</property>
							<value>1</value>
						</equals>
						<equals>
							<property>/options/autopilot</property>
							<value>S-TEC-55X</value>
						</equals>
					</and>
					<and>
						<equals>
							<property>/options/autopilot</property>
							<value>KAP140</value>
						</equals>
						<equals>
							<property>autopilot/kap140/panel/state</property>
							<value>6</value>
						</equals>
						<not><property>autopilot/kap140/settings/cws</property></not>
					</and>
				</or>
			</condition>
		</enable>
		<input>
			<condition>
				<and>
					<greater-than>
						<property>/it-stec55x/output/roll</property>
						<value>-1</value>
					</greater-than>
					<equals>
						<property>/it-stec55x/internal/servo-roll-power</property>
						<value>1</value>
					</equals>
					<equals>
						<property>/it-stec55x/settings/use-controls-flight</property>
						<value>1</value>
					</equals>
					<equals>
						<property>/options/autopilot</property>
						<value>S-TEC-55X</value>
					</equals>
				</and>
			</condition>
			<expression>
				<product>
					<sum>
						<property>/it-stec55x/internal/aileron-pi</property>
						<property>/it-stec55x/internal/aileron-d</property>
					</sum>
					<property>/it-stec55x/settings/gain-roll</property>
				</product>
			</expression>
		</input>
		<input>
			<condition>
				<and>
					<equals>
						<property>/options/autopilot</property>
						<value>KAP140</value>
					</equals>
					<greater-than>
						<property>autopilot/kap140/settings/lateral-mode</property>
						<value>0</value>
					</greater-than>
					<not><property>autopilot/kap140/settings/cws</property></not>
				</and>
			</condition>
			<property>autopilot/kap140/servo/aileron</property>
		</input>
		<output>/controls/flight/aileron</output>
		<max-rate-of-change>0.1</max-rate-of-change>
	</filter>
	<filter>
		<name>ELEVATOR OUTPUT</name>
		<debug>false</debug>
		<type>noise-spike</type>
		<enable>
			<condition>
				<or>
					<and>
						<greater-than>
							<property>/it-stec55x/output/pitch</property>
							<value>-1</value>
						</greater-than>
						<equals>
							<property>/it-stec55x/internal/servo-pitch-power</property>
							<value>1</value>
						</equals>
						<equals>
							<property>/it-stec55x/settings/use-controls-flight</property>
							<value>1</value>
						</equals>
						<equals>
							<property>/options/autopilot</property>
							<value>S-TEC-55X</value>
						</equals>
					</and>
					<and>
						<equals>
							<property>/options/autopilot</property>
							<value>KAP140</value>
						</equals>
						<greater-than>
							<property>autopilot/kap140/settings/vertical-mode</property>
							<value>0</value>
						</greater-than>
						<not><property>autopilot/kap140/settings/cws</property></not>
					</and>
				</or>
			</condition>
		</enable>
		<input>
			<condition>
				<and>
					<greater-than>
						<property>/it-stec55x/output/pitch</property>
						<value>-1</value>
					</greater-than>
					<equals>
						<property>/it-stec55x/internal/servo-pitch-power</property>
						<value>1</value>
					</equals>
					<equals>
						<property>/it-stec55x/settings/use-controls-flight</property>
						<value>1</value>
					</equals>
					<equals>
						<property>/options/autopilot</property>
						<value>S-TEC-55X</value>
					</equals>
				</and>
			</condition>
			<expression>
				<product>
					<property>/it-stec55x/internal/elevator-pi</property>
					<property>/it-stec55x/settings/gain-pitch</property>
				</product>
			</expression>
		</input>
		<input>
			<condition>
				<and>
					<equals>
						<property>/options/autopilot</property>
						<value>KAP140</value>
					</equals>
					<greater-than>
						<property>autopilot/kap140/settings/vertical-mode</property>
						<value>0</value>
					</greater-than>
					<not><property>autopilot/kap140/settings/cws</property></not>
				</and>
			</condition>
			<property>autopilot/kap140/servo/elevator</property>
		</input>
		<output>/controls/flight/elevator</output>
		<max-rate-of-change>0.1</max-rate-of-change>
	</filter>
</PropertyList>
